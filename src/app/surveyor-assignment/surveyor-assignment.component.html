<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container-fluid">
    <div style="margin-top: 5px;">
        <p  class="navigation">Survey
          Assignment  <img src="assets\survey.png" alt="" height="35px"></p>
        
      </div>
      <ul class="controls" style="list-style: none;">
       
        <li>
            <a class="glyphiconBorder" href="javascript:;" (click)="refresh()" title="Reload Hierarchy"><span
                class="glyphicon glyphicon-refresh text-success"></span></a>
          </li>
      </ul>
      <div class="vertical-line"></div>
      <div class="row" style="display: flex; padding: 10px;">
        <div>
            <h1>Circle</h1>
            <select class="form-control" aria-label="Select option" (change)="onCircleChange($event)">
                <option value="">--SELECT--</option>
                <option *ngFor="let item of circles" value={{item}}>{{item}}</option>
        
            </select>
        </div>
    <div>
        <h1>Sub Division</h1>
        <select class="form-control" aria-label="Select option" (change)="onSubDivisionChange($event)">
            <option value="">--SELECT--</option>
            <option *ngFor="let item of subDivisions" value={{item}}>{{item}}</option>
    
        </select>
    </div>
    <div *ngIf="role=='Contractor'">
       
            <h1>Surveyor</h1>
            <select class="form-control" aria-label="Select option" (change)="onSelectionChange($event)">
                <option value="">--SELECT--</option>
                <option *ngFor="let item of surveyorList" value={{item.id}}>{{item.name}}</option>
        
            </select>
       
    
</div>
   <div *ngIf="role=='Administrator'" >
    <div class="options">
        <button [class.selected]="selectedType === 'contractor'" (click)="selectType('contractor')">Contractor</button>
        <button [class.selected]="selectedType === 'surveyor'" (click)="selectType('surveyor')">Surveyor</button>
    </div>

    <section *ngIf="selectedType === 'contractor'">
        <select class="form-control" aria-label="Select option" (change)="onSelectionChange($event)">
            <option value="">--Contractor--</option>
            <option *ngFor="let item of contractors" [value]="item.id">{{item.name}}</option>
        </select>
    </section>

    <section *ngIf="selectedType === 'surveyor'">
        <select class="form-control" aria-label="Select option" (change)="onSelectionChange($event)">
            <option value="">--Surveyor--</option>
            <option *ngFor="let item of surveyorList" [value]="item.id">{{item.name}}</option>
        </select>
    </section>
</div>
</div>


   
    <hr>
    
    <div class="row" style="margin-left: 0px; margin-right: 0px;">
        <div class="col-12">
            <a role="button"  (click)="showPendingSurveys = !showPendingSurveys">
                <h1 class="header">Pending Surveys</h1>
            </a>
            <div [ngClass]="{'slide-in': showPendingSurveys, 'slide-out': !showPendingSurveys}">
                <select  (change)="onPendingPageChange($event)" style="height: 35px; width: 120px;">
                    <option value="10">10</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="500">500</option>
                    <option value="1000">1000</option>
                </select>
                <select  aria-label="Select option" (change)="onSelectionChange($event)" style="margin-left: 10px;height: 35px; width: 120px;" *ngIf="role=='Contractor'">
                    <option value="">--ALL--</option>
                    <option  [value]="id">{{contractorName}}</option>
                </select>
                <button type="button" class="btn btn-primary" style="margin-left: 10px;" on-click="Download()">Export</button>
                <div class="table-responsive" style="max-height: 700px; min-height: 300px;">
                    <table class="table table-striped table-bordered " >
                        <thead style="position: sticky;top: 0; color: white; background-color: black;">
                            <tr>
                                <th><input type="checkbox" [(ngModel)]="selectAllDeleteChecked"
                                    (change)="DeleteAllRowCheckboxes()"></th>
                                <th> SURVEY ID</th>
                                <th> CREATION DATE </th>
                                <th> ASSIGNED DATE</th>
                                <th> LONGITUDE </th>
                                <th> LATITUDE </th>
                                <th> ALTITUDE </th>
                                <th> LANDMARK </th>
                                <th> ASSIGNED TO </th>
                                <th> SUB DIVISION</th>
                                <th> STATUS </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let survey of Pendingsurveys">
                                <td><input type="checkbox" [(ngModel)]="DeleterowCheckboxes[survey.uid]"
                                    (change)="onDeleteRowCheckboxChange($event, survey.uid)"> </td>
                                <td>{{survey.id }}</td>
                                <td>{{survey.creationDate }}</td>
                                <td>{{survey.assignedDate}}</td>
                                <td>{{survey.longitude }}</td>
                                <td>{{survey.latitude }}</td>
                                <td>{{survey.altitude }}</td>
                                <td>{{survey.landmark }}</td>
                                <td>{{GetUsername(survey.assignedTo)}}</td>
                                <td>{{survey.subDivision }}</td>
                                <td>{{survey.status }}</td>
                                
                            </tr>
                        </tbody>
                    </table>

                </div>


                <div style="text-align: center;">
                    <ul class="pagination" style="margin-right: 40; margin-top: 10px;">
                        <li class="page-item" [class.disabled]="currentPendingPage === 1">
                            <a class="page-link" (click)="prevPage()" role="button" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <!-- <li class="page-item" *ngFor="let page of totalPendingPages"
                            [class.disabled]="currentPendingPage === page">
                            <a class="page-link" (click)="goToPage(page)" role="button">{{ page }}</a>
                        </li> -->
                        <li class="page-item">
                            <a class="page-link" >{{ currentPendingPage }}</a>
                        </li>
                        <li class="page-item" [class.disabled]="currentPendingPage === totalPendingPages.length">
                            <a class="page-link" (click)="nextPage()" role="button" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                        <li style="margin-left: 20px" *ngIf="role=='Administrator'">
                            <input type="button" class="btn btn-danger" name="" id="" value="Delete Selected"
                                (click)="DeleteAllSurveys()">
                        </li>
                        <li style="margin-left: 20px">
                            <input type="button" class="btn btn-info" name="" id="" value="Transfer Selected"
                                (click)="TransferAllSurveys()">
                        </li>

                    </ul>
                    <p style="font-size: smaller;">Total Pages - {{totalPendingPages.length}}&nbsp;&nbsp;&nbsp;
                      Total Data - {{totalPendingUsers}}</p>

                </div>
            </div>

        </div>
    </div>
   
    <hr>
  
    <div class="row" style="margin-left: 0px; margin-right: 0px;" *ngIf="role=='Administrator'">
        <div class="col-12">
            <a role="button" (click)="showUnassignedSurveys = !showUnassignedSurveys">
                <h1 class="header">Unassigned Surveys</h1>
            </a>
            <div [ngClass]="{'slide-in': showUnassignedSurveys, 'slide-out': !showUnassignedSurveys}">

             
                <select name="" id="" (change)="onPageChange($event)" style="height: 35px; width: 120px;">
                    <option value="10">10</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="500">500</option>
                    <option value="1000">1000</option>
                </select>
                <div class="table-responsive " style="max-height: 700px; min-height: 300px;">
                    <table class="table table-striped table-bordered " >
                        <thead style="position: sticky;top: 0; background-color: black; color: white; font-weight: 100;">
                            <tr>
                                <th><input type="checkbox" [(ngModel)]="selectAllChecked"
                                        (change)="updateAllRowCheckboxes()"></th>
                                        <th> SURVEY ID</th>
                                <th> CREATION DATE </th>
                                <th> ASSIGNED DATE</th>
                                <th> LONGITUDE </th>
                                <th> LATITUDE </th>
                                <th> ALTITUDE </th>
                                <th> LANDMARK </th>
                                <th> ASSIGNED TO </th>
                                <th> SUB DIVISION</th>
                                <th> STATUS </th>
                               

                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let survey of UnassignedSurveys">
                                <td><input type="checkbox" [(ngModel)]="rowCheckboxes[survey.uid]"
                                        (change)="onRowCheckboxChange($event, survey.uid)"> </td>
                                <td>{{survey.id }}</td>
                                <td>{{survey.creationDate }}</td>
                                <td>{{survey.assignedDate}}</td>
                                <td>{{survey.longitude }}</td>
                                <td>{{survey.latitude }}</td>
                                <td>{{survey.altitude }}</td>
                                <td>{{survey.landmark }}</td>
                                <td>None</td>
                                <td>{{survey.subDivision }}</td>
                                <td>{{survey.status }}</td>
                               
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="text-align: center;">
                    <ul class="pagination" style="margin-right: 40; margin-top: 10px;">
                        <li class="page-item" [class.disabled]="currentUnassignedPage === 1">
                            <a class="page-link" (click)="prevUnassignedPage()" role="button" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <!-- <li class="page-item" *ngFor="let page of totalUnassignedPages"
                            [class.disabled]="currentUnassignedPage === page">
                            <a class="page-link" (click)="goToUnassignedPage(page)" role="button">{{ page }}</a>
                        </li> -->
                         <li class="page-item">
                            <a class="page-link" >{{ currentUnassignedPage }}</a>
                        </li>
                        <li class="page-item" [class.disabled]="currentUnassignedPage === totalUnassignedPages.length">
                            <a class="page-link" (click)="nextUnassignedPage()" role="button" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>

                        <li style="margin-left: 20px">
                            <input type="button" class="btn btn-success" name="" id="" value="Submit"
                                (click)="submitSelectedRows()">
                        </li>
                        <li style="margin-left: 20px">
                            <input type="button" class="btn btn-danger" name="" id="" value="Delete Selected"
                                (click)="DeleteUnassingedSurveys()">
                        </li>

                    </ul>
                    <p style="font-size: smaller;">Total Pages - {{totalUnassignedPages.length}}&nbsp;&nbsp;&nbsp;Total Data - {{totalUnassignedUsers}}</p>
                </div>
                

            </div>


        </div>



    </div>
</div>